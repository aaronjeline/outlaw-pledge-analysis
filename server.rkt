#lang racket
((λ (label g11505) () (begin (label g11506) (syscall (label g11507) syscall_socket))))
((λ (label g11510) (i0 i1) (begin (label g11511) (syscall (label g11512) syscall_bind (var (label g11513) i0)) (syscall (label g11514) syscall_listen (var (label g11515) i1)))) (var (label g11516) servSock) (var (label g11517) port))
((var (label g11520) vector) (prim (label g11521) 0) (prim (label g11522) 0) (prim (label g11523) 0) (prim (label g11524) 0) (prim (label g11525) 0))
((λ (label g11530) (i0 i1) (begin (label g11531) (syscall (label g11532) syscall_read (var (label g11533) i0) (var (label g11534) i1)))) (var (label g11535) client) (var (label g11536) v))
((λ (label g11538) (i0) (begin (label g11539) (syscall (label g11540) syscall_write (var (label g11541) i0)))) (prim (label g11542) Got msg: ))
((λ (label g11544) (i0) (begin (label g11545) (syscall (label g11546) syscall_write (var (label g11547) i0)))) (app (label g11548) ((var (label g11549) vector->string) (var (label g11550) v))))
((var (label g11549) vector->string) (var (label g11550) v))
((λ (label g11552) (i0 i1) (begin (label g11553) (syscall (label g11554) syscall_write (var (label g11555) i0) (var (label g11556) i1)))) (var (label g11557) client) (var (label g11558) v))
((λ (label g11560) (i0) (begin (label g11561) (syscall (label g11562) syscall_close (var (label g11563) i0)))) (var (label g11564) client))
((var (label g11569) handle-client) (app (label g11570) ((λ (label g11571) (i0) (begin (label g11572) (syscall (label g11573) syscall_accept (var (label g11574) i0)))) (var (label g11575) servSock))))
((λ (label g11571) (i0) (begin (label g11572) (syscall (label g11573) syscall_accept (var (label g11574) i0)))) (var (label g11575) servSock))
((var (label g11577) loop))
((var (label g11580) loop))
'(begin (forbid syscall_dup2) (forbid syscall_fadvise64) (forbid syscall_prlimit64) (forbid syscall_shmat) (forbid syscall_fchmod) (forbid syscall_bind) (forbid syscall_waitid) (forbid syscall_pause) (forbid syscall_chown) (forbid syscall_inotify_init1) (forbid syscall_setreuid) (forbid syscall_sched_setaffinity) (forbid syscall_munlock) (forbid syscall_vserver) (forbid syscall_clone) (forbid syscall_putpmsg) (forbid syscall_recvfrom) (forbid syscall_eventfd) (forbid syscall_add_key) (forbid syscall_getsockopt) (forbid syscall_get_mempolicy) (forbid syscall_execve) (forbid syscall_create_module) (forbid syscall_fsetxattr) (forbid syscall_listen) (forbid syscall_pkey_alloc) (forbid syscall_ustat) (forbid syscall_ftruncate) (forbid syscall_poll) (forbid syscall_socketpair) (forbid syscall_fsopen) (forbid syscall_memfd_create) (forbid syscall_fsync) (forbid syscall_symlink) (forbid syscall_getdents) (forbid syscall_fspick) (forbid syscall_alarm) (forbid syscall_geteuid) (forbid syscall_rt_sigprocmask) (forbid syscall_openat2) (forbid syscall_capset) (forbid syscall_ioprio_get) (forbid syscall_fanotify_mark) (forbid syscall_signalfd) (forbid syscall_clock_adjtime) (forbid syscall_rt_sigtimedwait) (forbid syscall_timerfd_create) (forbid syscall_setitimer) (forbid syscall_seccomp) (forbid syscall_io_getevents) (forbid syscall_setrlimit) (forbid syscall_readlink) (forbid syscall_setgid) (forbid syscall_faccessat2) (forbid syscall_msgrcv) (forbid syscall_io_uring_setup) (forbid syscall_timer_getoverrun) (forbid syscall_statfs) (forbid syscall_wait4) (forbid syscall_semget) (forbid syscall_set_mempolicy) (forbid syscall_pread64) (forbid syscall_dup) (forbid syscall_preadv2) (forbid syscall_getrlimit) (forbid syscall_readv) (forbid syscall_splice) (forbid syscall_setsockopt) (forbid syscall_linkat) (forbid syscall_setfsuid) (forbid syscall_chroot) (forbid syscall_personality) (forbid syscall_madvise) (forbid syscall_clock_nanosleep) (forbid syscall_newfstatat) (forbid syscall_clone3) (forbid syscall_epoll_wait) (forbid syscall_fstatfs) (forbid syscall_settimeofday) (forbid syscall_semtimedop) (forbid syscall_epoll_pwait) (forbid syscall_landlock_create_ruleset) (forbid syscall_keyctl) (forbid syscall_bpf) (forbid syscall_getdents64) (forbid syscall_mmap) (forbid syscall_rt_sigsuspend) (forbid syscall_msgctl) (forbid syscall_epoll_wait_old) (forbid syscall_arch_prctl) (forbid syscall_uselib) (forbid syscall_shmctl) (forbid syscall_renameat2) (forbid syscall_getsid) (forbid syscall_getpmsg) (forbid syscall_process_vm_writev) (forbid syscall_access) (forbid syscall_signalfd4) (forbid syscall_sethostname) (forbid syscall_sched_getparam) (forbid syscall_clock_gettime) (forbid syscall_stat) (forbid syscall_timer_create) (forbid syscall_move_mount) (forbid syscall_setxattr) (forbid syscall_mkdir) (forbid syscall_sync_file_range) (forbid syscall_modify_ldt) (forbid syscall_lookup_dcookie) (forbid syscall_truncate) (forbid syscall_nfsservctl) (forbid syscall_perf_event_open) (forbid syscall_accept) (forbid syscall_tkill) (forbid syscall_epoll_ctl) (forbid syscall_timer_gettime) (forbid syscall_mq_timedsend) (forbid syscall_umount2) (forbid syscall_get_thread_area) (forbid syscall_lremovexattr) (forbid syscall_name_to_handle_at) (forbid syscall_sigaltstack) (forbid syscall_swapoff) (forbid syscall_setns) (forbid syscall_kcmp) (forbid syscall_getrusage) (forbid syscall_open_tree) (forbid syscall_ioperm) (forbid syscall_sched_getscheduler) (forbid syscall_flistxattr) (forbid syscall_get_kernel_syms) (forbid syscall_readlinkat) (forbid syscall_sched_setattr) (forbid syscall_timer_delete) (forbid syscall_fremovexattr) (forbid syscall_mincore) (forbid syscall_finit_module) (forbid syscall_ioprio_set) (forbid syscall_getcpu) (forbid syscall_inotify_init) (forbid syscall_membarrier) (forbid syscall_prctl) (forbid syscall_getppid) (forbid syscall_setresuid) (forbid syscall_set_tid_address) (forbid syscall_accept4) (forbid syscall_pidfd_send_signal) (forbid syscall_adjtimex) (forbid syscall_eventfd2) (forbid syscall_pwrite64) (forbid syscall_landlock_restrict_self) (forbid syscall_fchmodat) (forbid syscall_lsetxattr) (forbid syscall_listxattr) (forbid syscall_setuid) (forbid syscall_delete_module) (forbid syscall_rt_sigpending) (forbid syscall_llistxattr) (forbid syscall_pipe) (forbid syscall_rt_sigreturn) (forbid syscall_removexattr) (forbid syscall_unshare) (forbid syscall_inotify_rm_watch) (forbid syscall_recvmsg) (forbid syscall_fchdir) (forbid syscall_afs_syscall) (forbid syscall_mq_unlink) (forbid syscall_write) (forbid syscall_mount) (forbid syscall_exit_group) (forbid syscall_open_by_handle_at) (forbid syscall_pidfd_open) (forbid syscall_swapon) (forbid syscall_mq_notify) (forbid syscall_gettimeofday) (forbid syscall_unlinkat) (forbid syscall_mq_open) (forbid syscall_get_robust_list) (forbid syscall_userfaultfd) (forbid syscall_sendfile) (forbid syscall_close) (forbid syscall_syslog) (forbid syscall_gettid) (forbid syscall_openat) (forbid syscall_symlinkat) (forbid syscall_migrate_pages) (forbid syscall_rt_sigaction) (forbid syscall_inotify_add_watch) (forbid syscall_getresgid) (forbid syscall_ppoll) (forbid syscall_io_submit) (forbid syscall_fdatasync) (forbid syscall_sendmmsg) (forbid syscall_fallocate) (forbid syscall_sched_getattr) (forbid syscall_fstat) (forbid syscall_io_cancel) (forbid syscall_tee) (forbid syscall_unlink) (forbid syscall_pipe2) (forbid syscall_time) (forbid syscall_sendmsg) (forbid syscall_getgroups) (forbid syscall_sched_setscheduler) (forbid syscall_pwritev) (forbid syscall_iopl) (forbid syscall_mq_getsetattr) (forbid syscall_lgetxattr) (forbid syscall_setsid) (forbid syscall_init_module) (forbid syscall_process_madvise) (forbid syscall_getpgrp) (forbid syscall_mknod) (forbid syscall_epoll_ctl_old) (forbid syscall_mknodat) (forbid syscall_semctl) (forbid syscall_fgetxattr) (forbid syscall_sysfs) (forbid syscall_umask) (forbid syscall_io_pgetevents) (forbid syscall_getxattr) (forbid syscall_faccessat) (forbid syscall_close_range) (forbid syscall_pselect6) (forbid syscall_getresuid) (forbid syscall_fsmount) (forbid syscall__sysctl) (forbid syscall_statx) (forbid syscall_mq_timedreceive) (forbid syscall_sched_getaffinity) (forbid syscall_select) (forbid syscall_msgget) (forbid syscall_recvmmsg) (forbid syscall_acct) (forbid syscall_nanosleep) (forbid syscall_uname) (forbid syscall_chmod) (forbid syscall_io_uring_register) (forbid syscall_setdomainname) (forbid syscall_setpgid) (forbid syscall_setpriority) (forbid syscall_brk) (forbid syscall_set_robust_list) (forbid syscall_setfsgid) (forbid syscall_msgsnd) (forbid syscall_getuid) (forbid syscall_capget) (forbid syscall_link) (forbid syscall_futimesat) (forbid syscall_reboot) (forbid syscall_epoll_pwait2) (forbid syscall_security) (forbid syscall_sched_rr_get_interval) (forbid syscall_connect) (forbid syscall_semop) (forbid syscall_munmap) (forbid syscall_timer_settime) (forbid syscall_query_module) (forbid syscall_move_pages) (forbid syscall_sched_setparam) (forbid syscall_utime) (forbid syscall_copy_file_range) (forbid syscall_vmsplice) (forbid syscall_preadv) (forbid syscall_clock_getres) (forbid syscall_pwritev2) (forbid syscall_vhangup) (forbid syscall_fork) (forbid syscall_clock_settime) (forbid syscall_syncfs) (forbid syscall_fcntl) (forbid syscall_ioctl) (forbid syscall_getgid) (forbid syscall_kexec_file_load) (forbid syscall_kexec_load) (forbid syscall_tuxcall) (forbid syscall_setgroups) (forbid syscall_timerfd_gettime) (forbid syscall_rseq) (forbid syscall_timerfd_settime) (forbid syscall_io_setup) (forbid syscall_getegid) (forbid syscall_rmdir) (forbid syscall_io_destroy) (forbid syscall_epoll_create) (forbid syscall_open) (forbid syscall_times) (forbid syscall_rt_sigqueueinfo) (forbid syscall_sysinfo) (forbid syscall_execveat) (forbid syscall_setregid) (forbid syscall_fsconfig) (forbid syscall_mlockall) (forbid syscall_set_thread_area) (forbid syscall_read) (forbid syscall_utimensat) (forbid syscall_exit) (forbid syscall_munlockall) (forbid syscall_lstat) (forbid syscall_mprotect) (forbid syscall_pidfd_getfd) (forbid syscall_rt_tgsigqueueinfo) (forbid syscall_sched_get_priority_min) (forbid syscall_sched_get_priority_max) (forbid syscall_readahead) (forbid syscall_flock) (forbid syscall_shmget) (forbid syscall_setresgid) (forbid syscall_rename) (forbid syscall_writev) (forbid syscall_getpeername) (forbid syscall_shmdt) (forbid syscall_mlock2) (forbid syscall_kill) (forbid syscall_getpgid) (forbid syscall_socket) (forbid syscall_creat) (forbid syscall_lchown) (forbid syscall_pivot_root) (forbid syscall_pkey_mprotect) (forbid syscall_getsockname) (forbid syscall_getpriority) (forbid syscall_mbind) (forbid syscall_sched_yield) (forbid syscall_utimes) (forbid syscall_lseek) (forbid syscall_process_vm_readv) (forbid syscall_getpid) (forbid syscall_remap_file_pages) (forbid syscall_pkey_free) (forbid syscall_sync) (forbid syscall_getrandom) (forbid syscall_mlock) (forbid syscall_fanotify_init) (forbid syscall_tgkill) (forbid syscall_getitimer) (forbid syscall_fchown) (forbid syscall_epoll_create1) (forbid syscall_io_uring_enter) (forbid syscall_mremap) (forbid syscall_ptrace) (forbid syscall_quotactl) (forbid syscall_futex) (forbid syscall_mount_setattr) (forbid syscall_request_key) (forbid syscall_chdir) (forbid syscall_vfork) (forbid syscall_msync) (forbid syscall_getcwd) (forbid syscall_fchownat) (forbid syscall_restart_syscall) (forbid syscall_dup3) (forbid syscall_landlock_add_rule) (forbid syscall_sendto) (forbid syscall_renameat) (forbid syscall_shutdown) (forbid syscall_mkdirat) (begin (let ((port 1337)) (let ((servSock ((λ () (begin (syscall_socket)))))) (begin (forbid syscall_socket) ((λ (i0 i1) (begin (syscall_bind i0) (begin (forbid syscall_bind) (syscall_listen i1)))) servSock port) (begin (forbid syscall_listen) (let ((v (vector 0 0 0 0 0))) (let ((handle-client (rec handle-client (client) (begin ((λ (i0 i1) (begin (syscall_read i0 i1))) client v) ((λ (i0) (begin (syscall_write i0))) "Got msg: ") ((λ (i0) (begin (syscall_write i0))) (vector->string v)) ((λ (i0 i1) (begin (syscall_write i0 i1))) client v) ((λ (i0) (begin (syscall_close i0))) client))))) (let ((loop (rec loop () (begin (handle-client ((λ (i0) (begin (syscall_accept i0))) servSock)) (loop))))) (begin (loop) (begin (forbid syscall_read) 1)))))))))))